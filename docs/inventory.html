---

title: Inventory


keywords: fastai
sidebar: home_sidebar

summary: "upload and download inventory data from villa master backend"
description: "upload and download inventory data from villa master backend"
nb_path: "inventory.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: inventory.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Endpoints" class="doc_header"><code>class</code> <code>Endpoints</code><a href="https://github.com/nic/villaInventorySdk/tree/master/villaInventorySdk/inventory.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Endpoints</code>(<strong><code>branchName</code></strong>=<em><code>'manual-dev'</code></em>)</p>
</blockquote>
<p>get endpoint names from branch name</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InventorySdk" class="doc_header"><code>class</code> <code>InventorySdk</code><a href="https://github.com/nic/villaInventorySdk/tree/master/villaInventorySdk/inventory.py#L25" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InventorySdk</code>(<strong><code>branchName</code></strong>=<em><code>'dev'</code></em>, <strong><code>user</code></strong>=<em><code>None</code></em>, <strong><code>pw</code></strong>=<em><code>None</code></em>, <strong><code>region</code></strong>=<em><code>'ap-southeast-1'</code></em>)</p>
</blockquote>
<p>interact with villa inventory database</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">dataclasses_json</span> <span class="kn">import</span> <span class="n">dataclass_json</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">boto3</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="generate-dummy-data-for-testing">generate dummy data for testing<a class="anchor-link" href="#generate-dummy-data-for-testing"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1">#Dummy Data</span>
<span class="n">numberOfRows</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="nd">@dataclass_json</span>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Inventory</span><span class="p">:</span>
  <span class="n">ib_prcode</span><span class="p">:</span><span class="nb">str</span>
  <span class="n">ib_brcode</span><span class="p">:</span><span class="nb">str</span>
  <span class="n">ib_cf_qty</span><span class="p">:</span><span class="nb">str</span>
  <span class="n">new_ib_vs_stock_cv</span><span class="p">:</span><span class="nb">str</span>

<span class="n">sampleLargeRandomInput</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Inventory</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span>
    <span class="s1">&#39;ib_brcode&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1030</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
    <span class="s1">&#39;ib_prcode&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">100000</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
    <span class="s1">&#39;ib_cf_qty&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
    <span class="s1">&#39;new_ib_vs_stock_cv&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
  <span class="p">})</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfRows</span><span class="p">)]</span>
<span class="n">sampleLargeRandomInput</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 108 ms, sys: 67 Âµs, total: 108 ms
Wall time: 107 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ib_prcode&#39;: &#39;43245&#39;,
 &#39;ib_brcode&#39;: &#39;1015&#39;,
 &#39;ib_cf_qty&#39;: &#39;308&#39;,
 &#39;new_ib_vs_stock_cv&#39;: &#39;979&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="create-main-object">create main object<a class="anchor-link" href="#create-main-object"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sdk</span> <span class="o">=</span> <span class="n">InventorySdk</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">USER</span><span class="p">,</span> <span class="n">pw</span><span class="o">=</span><span class="n">PW</span><span class="p">,</span> <span class="n">branchName</span> <span class="o">=</span> <span class="s1">&#39;dev-manual&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Upload-the-batch-data-using-s3">Upload the batch data using s3<a class="anchor-link" href="#Upload-the-batch-data-using-s3"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;uploading </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sampleLargeRandomInput</span><span class="p">)</span><span class="si">}</span><span class="s1"> items&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sdk</span><span class="o">.</span><span class="n">updateWithS3</span><span class="p">(</span>
    <span class="n">sampleLargeRandomInput</span><span class="p">,</span>
    <span class="n">invocationType</span> <span class="o">=</span> <span class="s1">&#39;Event&#39;</span>
  <span class="p">)</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>uploading 1000 items
CPU times: user 50 ms, sys: 15.8 ms, total: 65.8 ms
Wall time: 143 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;true&#39;, &#39;statusCode&#39;: 200, &#39;header&#39;: {}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Query-Single-Product">Query Single Product<a class="anchor-link" href="#Query-Single-Product"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">sdk</span><span class="o">.</span><span class="n">querySingleProduct</span><span class="p">(</span><span class="s1">&#39;0000002&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 13.7 ms, sys: 437 Âµs, total: 14.1 ms
Wall time: 2.07 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;{&#34;ib_prcode&#34;:&#34;0000002&#34;,&#34;1000&#34;:{&#34;ib_cf_qty&#34;:35,&#34;new_ib_bs_stock_cv&#34;:33,&#34;lastUpdate&#34;:1600567810.529301},&#34;1001&#34;:{&#34;ib_cf_qty&#34;:32,&#34;new_ib_bs_stock_cv&#34;:30,&#34;lastUpdate&#34;:1600567810.529316},&#34;1002&#34;:{&#34;ib_cf_qty&#34;:34,&#34;new_ib_bs_stock_cv&#34;:30,&#34;lastUpdate&#34;:1600567810.529318},&#34;lastUpdate&#34;:1600567810.529318}&#39;,
 &#39;statusCode&#39;: 200,
 &#39;header&#39;: {}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">sdk</span><span class="o">.</span><span class="n">querySingleProduct</span><span class="p">(</span><span class="s1">&#39;392070&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 3.5 ms, sys: 343 Âµs, total: 3.84 ms
Wall time: 96.9 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;body&#39;: &#39;&#34;missing product {\&#39;ib_prcode\&#39;: \&#39;392070\&#39;}&#34;&#39;,
 &#39;statusCode&#39;: 400,
 &#39;header&#39;: {}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Query-a-branch">Query a branch<a class="anchor-link" href="#Query-a-branch"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sdk</span><span class="o">.</span><span class="n">queryBranch</span><span class="p">(</span><span class="s1">&#39;1000&#39;</span><span class="p">)</span>
<span class="c1">#showing the first 2 result</span>
<span class="nb">list</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">()))[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 236 ms, sys: 7.79 ms, total: 244 ms
Wall time: 447 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;0000009&#39;,
  {&#39;ib_cf_qty&#39;: 50,
   &#39;new_ib_bs_stock_cv&#39;: 27,
   &#39;lastUpdate&#39;: 1602338504.869655}),
 (&#39;0000002&#39;,
  {&#39;ib_cf_qty&#39;: 35,
   &#39;new_ib_bs_stock_cv&#39;: 33,
   &#39;lastUpdate&#39;: 1600567810.529301})]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Query-All">Query All<a class="anchor-link" href="#Query-All"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sdk</span><span class="o">.</span><span class="n">queryAll</span><span class="p">()</span>
<span class="nb">list</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">()))[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1.75 s, sys: 63.5 ms, total: 1.81 s
Wall time: 2.08 s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;0000009&#39;,
  {&#39;ib_prcode&#39;: &#39;0000009&#39;,
   &#39;1000&#39;: {&#39;ib_cf_qty&#39;: 50,
    &#39;new_ib_bs_stock_cv&#39;: 27,
    &#39;lastUpdate&#39;: 1602338504.869655},
   &#39;lastUpdate&#39;: 1602338504.869655}),
 (&#39;0000002&#39;,
  {&#39;ib_prcode&#39;: &#39;0000002&#39;,
   &#39;1000&#39;: {&#39;ib_cf_qty&#39;: 35,
    &#39;new_ib_bs_stock_cv&#39;: 33,
    &#39;lastUpdate&#39;: 1600567810.529301},
   &#39;1001&#39;: {&#39;ib_cf_qty&#39;: 32,
    &#39;new_ib_bs_stock_cv&#39;: 30,
    &#39;lastUpdate&#39;: 1600567810.529316},
   &#39;1002&#39;: {&#39;ib_cf_qty&#39;: 34,
    &#39;new_ib_bs_stock_cv&#39;: 30,
    &#39;lastUpdate&#39;: 1600567810.529318},
   &#39;lastUpdate&#39;: 1600567810.529318})]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

